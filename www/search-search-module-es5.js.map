{"version":3,"sources":["./src/app/components/search/search.page.html","./src/app/components/search/search.module.ts","./src/app/components/search/search.page.scss","./src/app/components/search/search.page.ts","./src/app/services/search.service.ts"],"names":[],"mappings":";;;;;;;;;AAAA,6pBAA6pB,6DAA6D,sHAAsH,eAAe,4DAA4D,YAAY,4OAA4O,iCAAiC,yBAAyB,4CAA4C,4P;;;;;;;;;;;;;;;;;;;;;;ACAhtC;AACM;AACF;AACU;AAEV;AAEF;AAE3C,IAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,uDAAU;KACtB;CACF,CAAC;AAWF;IAAA;IAA+B,CAAC;IAAnB,gBAAgB;QAT5B,8DAAQ,CAAC;YACR,OAAO,EAAE;gBACP,4DAAY;gBACZ,0DAAW;gBACX,0DAAW;gBACX,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC;aAC9B;YACD,YAAY,EAAE,CAAC,uDAAU,CAAC;SAC3B,CAAC;OACW,gBAAgB,CAAG;IAAD,uBAAC;CAAA;AAAH;;;;;;;;;;;;ACzB7B,+DAA+D,uJ;;;;;;;;;;;;;;;;;;;;ACAb;AACwC;AAC5B;AAE3B;AAOnC;IAMC,oBAAmB,OAAsB,EACjC,aAA4B,EAC3B,WAA8B;QAFpB,YAAO,GAAP,OAAO,CAAe;QACjC,kBAAa,GAAb,aAAa,CAAe;QAC3B,gBAAW,GAAX,WAAW,CAAmB;QACrC,IAAI,CAAC,aAAa,EAAE,CAAC;IAEtB,CAAC;IAED,6BAAQ,GAAR;IACA,CAAC;IACK,kCAAa,GAAnB;;;;;;4BACe,qBAAM,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC;4BAC5C,OAAO,EAAE,iBAAiB;yBAC1B,CAAC;;wBAFI,MAAM,GAAG,SAEb;wBACF,MAAM,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC;4BACrB,KAAI,CAAC,GAAG,GAAG,YAAY,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;4BACvC,KAAI,CAAC,KAAK,GAAG,KAAI,CAAC,SAAS,GAAG,KAAI,CAAC,aAAa,CAAC,SAAS,EAAE,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,0DAAG,CAAE,eAAK;gCAC1F,OAAO,KAAK,CAAC,GAAG,CAAC,UAAC,IAAS;oCAC1B,IAAI,CAAC,gBAAgB,GAAG,KAAI,CAAC,aAAa,CAAC,gBAAgB,CAAC,IAAI,CAAC,GAAG,EAAE,KAAI,CAAC,GAAG,CAAC,CAAC,YAAY,EAAE,CAAC;oCAC/F,OAAO,mDAAK,IAAI,EAAG;gCACpB,CAAC,CAAC,CAAC;4BACJ,CAAC,CAAC,CAAC,CAAC;wBACL,CAAC,CAAC,CAAC,IAAI,CAAC;4BACP,MAAM,CAAC,OAAO,EAAE,CAAC;wBAClB,CAAC,CAAC,CAAC;;;;;KACF;IACF,kCAAa,GAAb,UAAc,KAAK;QAAnB,iBAYC;QAXA,IAAI,GAAG,GAAG,KAAK,CAAC,MAAM,CAAC,KAAK,CAAC;QAC7B,IAAI,GAAG,IAAI,GAAG,CAAC,IAAI,EAAE,IAAI,EAAE,EAAE;YAC5B,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,0DAAG,CAAE,eAAK;gBAC7E,OAAO,KAAK,CAAC,GAAG,CAAC,UAAC,IAAS;oBAC1B,IAAI,CAAC,gBAAgB,GAAG,KAAI,CAAC,aAAa,CAAC,gBAAgB,CAAC,IAAI,CAAC,GAAG,EAAE,KAAI,CAAC,GAAG,CAAC,CAAC,YAAY,EAAE,CAAC;oBAC/F,OAAO,mDAAK,IAAI,EAAG;gBACpB,CAAC,CAAC,CAAC;YACJ,CAAC,CAAC,CAAC,CAAC;SACJ;aAAM;YACN,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,SAAS,CAAC;SAC5B;IACF,CAAC;IAED,uCAAkB,GAAlB,UAAmB,WAAoB,EAAE,IAAI;QAC5C,IAAI,WAAW,EAAE;YAChB,IAAI,CAAC,aAAa,CAAC,YAAY,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC;SACvD;aAAM;YACN,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,IAAI,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,CAAC;SACrD;IACF,CAAC;IAED,sCAAiB,GAAjB,UAAkB,GAAG;QACpB,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC,mBAAmB,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,CAAC,CAAC;IAChE,CAAC;IAED,iCAAY,GAAZ,UAAa,IAAK,EAAE,MAAO;QAC1B,IAAI,IAAI,EAAE;YACT,IAAI,CAAC,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC;YAChC,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC,UAAU,CAAC;YACpC,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC,UAAU,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC,CAAC;SACxD;aAAM;YACN,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,UAAU,CAAC,CAAC;SACtC;IACF,CAAC;;gBA3D2B,4DAAa;gBAClB,sEAAa;gBACd,gEAAiB;;IAR3B,UAAU;QALtB,+DAAS,CAAC;YACT,QAAQ,EAAE,YAAY;YACtB,qJAAiC;;SAElC,CAAC;+EAO2B,4DAAa;YAClB,sEAAa;YACd,gEAAiB;OAR3B,UAAU,CAkEtB;IAAD,iBAAC;CAAA;AAlEsB;;;;;;;;;;;;;;;;;;;;ACXoB;AAC2C;AAItF;IAGE,uBAAoB,SAA2B;QAA3B,cAAS,GAAT,SAAS,CAAkB;QAC7C,IAAI,CAAC,KAAK,GAAG,SAAS,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;IAC7C,CAAC;IAED,iCAAS,GAAT;QACE,OAAO,IAAI,CAAC,KAAK,CAAC;IACpB,CAAC;IAED,wCAAgB,GAAhB,UAAiB,IAAI,EAAE,IAAI;QACzB,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,UAAU,CAAC,aAAa,EAAE,aAAG,IAAI,UAAG,CAAC,KAAK,CAAC,aAAa,EAAE,IAAI,EAAE,IAAI,CAAC,EAApC,CAAoC,CAAC,CAAC;IACrG,CAAC;IAED,kCAAU,GAAV,UAAW,IAAI,EAAE,IAAI;QAArB,iBAUC;QATC,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC;YAClE,SAAS,EAAE,IAAI,CAAC,GAAG,EAAE;YACrB,WAAW,EAAE,IAAI;SAClB,CAAC,CAAC,IAAI,CAAC;YACN,KAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC;gBAC1D,SAAS,EAAE,IAAI,CAAC,GAAG,EAAE;gBACrB,UAAU,EAAE,IAAI;aACjB,CAAC,CAAC;QACL,CAAC,CAAC;IACJ,CAAC;IAED,oCAAY,GAAZ,UAAa,IAAI,EAAE,IAAI;QAAvB,iBAIC;QAHC,OAAO,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,CAAC,IAAI,CAAC;YAC5E,KAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,UAAU,CAAC,YAAY,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC,MAAM,EAAE,CAAC;QACnE,CAAC,CAAC,CAAC;IACL,CAAC;IAED,kCAAU,GAAV,UAAW,GAAG;QACZ,OAAO,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,OAAO,EAAE,aAAG,IAAI,UAAG,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC,EAAxI,CAAwI,CAAC,CAAC;IAC7L,CAAC;;gBAhC8B,uEAAgB;;IAHpC,aAAa;QAHzB,gEAAU,CAAC;YACV,UAAU,EAAE,MAAM;SACnB,CAAC;+EAI+B,uEAAgB;OAHpC,aAAa,CAoCzB;IAAD,oBAAC;CAAA;AApCyB","file":"search-search-module-es5.js","sourcesContent":["module.exports = \"<!-- <ion-header>\\n  <ion-toolbar>\\n    <ion-title>search</ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content>\\n\\n</ion-content> -->\\n<ion-header>\\n    <ion-toolbar>\\n      <ion-searchbar (ionInput)=\\\"onEnterSearch($event)\\\"></ion-searchbar>\\n    </ion-toolbar>\\n  </ion-header>\\n  \\n  <ion-content class=\\\"search-content\\\">\\n    <div *ngIf=\\\"users | async as users\\\">\\n      <ion-item *ngIf=\\\"users?.length==0\\\">\\n        <p>No user found.!</p>\\n      </ion-item>\\n    </div>\\n    <div *ngFor=\\\"let user of users | async\\\">\\n      <ion-item class=\\\"item\\\" *ngIf=\\\"user?.uid != uid\\\">\\n        <ion-avatar item-left >\\n          <img src=\\\"{{user.profilePicThumb? user.profilePicThumb: user.profilePic}}\\\" class=\\\"img-avatar\\\">\\n        </ion-avatar>\\n        <h2 class=\\\"name\\\" (click)=\\\"goToOthersProfile(user.uid)\\\">{{user.username}}</h2>\\n        <p (click)=\\\"goToOthersProfile(user.uid)\\\">{{user.email}}</p>\\n  \\n        <div item-right class=\\\"right-btn\\\" *ngIf=\\\"user?.checkIsFollowing | async as following\\\">\\n          <button ion-button class=\\\"btn-follow\\\" (click)=\\\"followUnfollowUser(following.length==1, user?.uid)\\\" [ngClass]=\\\"{unfollowBtn: following.length==1}\\\">\\n            <span>{{following.length==1 ? 'UNFOLLOW': 'FOLLOW'}}</span>\\n          </button>\\n        </div>\\n      </ion-item>\\n    </div>\\n  \\n  </ion-content>\\n  \\n  \\n  <ion-fab bottom right (click)=\\\"goToPostPage()\\\">\\n    <button ion-fab>\\n      <ion-icon name=\\\"add\\\"></ion-icon>\\n    </button>\\n  </ion-fab>\"","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { SearchPage } from './search.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: SearchPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [SearchPage]\n})\nexport class SearchPageModule {}\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudHMvc2VhcmNoL3NlYXJjaC5wYWdlLnNjc3MifQ== */\"","import { Component, OnInit } from '@angular/core';\nimport {NavController, LoadingController, ToastController, Events } from '@ionic/angular';\nimport { SearchService } from '../../services/search.service';\nimport { Observable } from 'rxjs';\nimport {map} from 'rxjs/operators';\nimport {  } from 'rxjs/add/operator/take';\n@Component({\n  selector: 'app-search',\n  templateUrl: './search.page.html',\n  styleUrls: ['./search.page.scss'],\n})\nexport class SearchPage implements OnInit {\n\n  public users;\n\tpublic uid: string;\n\tpublic usersCopy;\n\n\tconstructor(public navCtrl: NavController,\n\t\tpublic searchService: SearchService,\n\t\tprivate loadingCtrl: LoadingController) {\n\t\t\tthis.constructorfn();\n\t\t\n  }\n  \n  ngOnInit() {\n  }\n  async constructorfn(){\n    let loader = await this.loadingCtrl.create({\n\t\t\tmessage: 'Getting list...'\n\t\t});\n\t\tloader.present().then(() => {\n\t\t\tthis.uid = localStorage.getItem('uid');\n\t\t\tthis.users = this.usersCopy = this.searchService.usersList().valueChanges().pipe(map( items => {\n\t\t\t\treturn items.map((item: any) => {\n\t\t\t\t\titem.checkIsFollowing = this.searchService.checkIsFollowing(item.uid, this.uid).valueChanges();\n\t\t\t\t\treturn { ...item };\n\t\t\t\t});\n\t\t\t}));\n\t\t}).then(() => {\n\t\t\tloader.dismiss();\n\t\t});\n  }\n\tonEnterSearch(event) {\n\t\tlet val = event.target.value;\n\t\tif (val && val.trim() != '') {\n\t\t\tthis.users = this.searchService.SearchUser(val).valueChanges().pipe(map( items => {\n\t\t\t\treturn items.map((item: any) => {\n\t\t\t\t\titem.checkIsFollowing = this.searchService.checkIsFollowing(item.uid, this.uid).valueChanges();\n\t\t\t\t\treturn { ...item };\n\t\t\t\t});\n\t\t\t}));\n\t\t} else {\n\t\t\tthis.users = this.usersCopy;\n\t\t}\n\t}\n\n\tfollowUnfollowUser(isFollowing: boolean, ouid) {\n\t\tif (isFollowing) {\n\t\t\tthis.searchService.unfollowUser(ouid, this.uid).then();\n\t\t} else {\n\t\t\tthis.searchService.followUser(ouid, this.uid).then();\n\t\t}\n\t}\n\n\tgoToOthersProfile(uid) {\n\t\tthis.navCtrl.navigateRoot([\"OthersProfilePage\", { uid: uid }]);\n\t}\n\n\tgoToPostPage(post?, postOf?) {\n\t\tif (post) {\n\t\t\tpost.playerId = postOf.playerId;\n\t\t\tpost.profilePic = postOf.profilePic;\n\t\t\tthis.navCtrl.navigateRoot([\"PostPage\", { post: post }]);\n\t\t} else {\n\t\t\tthis.navCtrl.navigateRoot(\"PostPage\");\n\t\t}\n\t}\n}\n","import { Injectable } from '@angular/core';\nimport { AngularFirestore, AngularFirestoreCollection } from 'angularfire2/firestore';\n@Injectable({\n  providedIn: 'root'\n})\nexport class SearchService {\n  private users: AngularFirestoreCollection<{}>;\n\n  constructor(private afService: AngularFirestore) {\n    this.users = afService.collection('users');\n  }\n\n  usersList() {\n    return this.users;\n  }\n\n  checkIsFollowing(ouid, cuid) {\n    return this.users.doc(cuid).collection('followingTo', ref => ref.where('followingTo', '==', ouid));\n  }\n\n  followUser(ouid, cuid) {\n    return this.users.doc(cuid).collection('followingTo').doc(ouid).set({\n      createdAt: Date.now(),\n      followingTo: ouid\n    }).then(() => {\n      this.users.doc(ouid).collection('followedBy').doc(cuid).set({\n        createdAt: Date.now(),\n        followedBy: cuid\n      });\n    })\n  }\n\n  unfollowUser(ouid, cuid) {\n    return this.users.doc(cuid).collection('followingTo').doc(ouid).delete().then(() => {\n      this.users.doc(ouid).collection('followedBy').doc(cuid).delete();\n    });\n  }\n\n  SearchUser(val) {\n    return this.afService.collection('users', ref => ref.orderBy('username').startAt(val.charAt(0).toUpperCase() + val.slice(1)).endAt(val.charAt(0).toUpperCase() + val.slice(1) + '\\uf8ff'));\n  }\n}\n"],"sourceRoot":""}